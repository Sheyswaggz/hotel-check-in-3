apiVersion: v1
kind: ConfigMap
metadata:
  name: hotel-checkin-config
  namespace: default
  labels:
    app: hotel-checkin
    component: configuration
    managed-by: kubernetes
  annotations:
    description: "Hotel check-in application configuration"
    version: "1.0.0"
data:
  # =============================================================================
  # APPLICATION CONFIGURATION
  # =============================================================================
  
  # Node Environment
  NODE_ENV: "production"
  
  # Server Configuration
  PORT: "3000"
  
  # Logging Configuration
  LOG_LEVEL: "info"
  LOG_FORMAT: "json"
  
  # =============================================================================
  # DATABASE CONFIGURATION
  # =============================================================================
  
  # Database Connection Settings (non-sensitive)
  DB_HOST: "postgres-svc"
  DB_PORT: "5432"
  DB_NAME: "hotel_checkin"
  DB_POOL_MIN: "2"
  DB_POOL_MAX: "10"
  DB_CONNECTION_TIMEOUT: "30000"
  
  # =============================================================================
  # AUTHENTICATION & SECURITY CONFIGURATION
  # =============================================================================
  
  # JWT Configuration (non-sensitive)
  JWT_ENABLED: "true"
  JWT_EXPIRES_IN: "24h"
  JWT_REFRESH_EXPIRES_IN: "7d"
  
  # Password Hashing Configuration
  BCRYPT_ROUNDS: "10"
  
  # =============================================================================
  # API CONFIGURATION
  # =============================================================================
  
  # Rate Limiting
  RATE_LIMIT_MAX: "100"
  RATE_LIMIT_WINDOW: "900000"
  
  # API Version
  API_VERSION: "v1"
  
  # CORS Configuration
  CORS_ORIGINS: "http://localhost:3000,http://localhost:3001"
  
  # Request Configuration
  MAX_FILE_SIZE: "10485760"
  ALLOWED_FILE_TYPES: "image/jpeg,image/png,application/pdf"
  
  # =============================================================================
  # FEATURE FLAGS
  # =============================================================================
  
  # Room Management Feature
  ROOM_MANAGEMENT_ENABLED: "true"
  FEATURE_ONLINE_CHECKIN: "true"
  FEATURE_MOBILE_KEY: "false"
  FEATURE_PAYMENT_PROCESSING: "true"
  FEATURE_NEW_UI: "true"
  FEATURE_ANALYTICS: "true"
  FEATURE_BETA: "false"
  
  # =============================================================================
  # MONITORING & OBSERVABILITY
  # =============================================================================
  
  # Logging
  LOG_REQUESTS: "true"
  DEBUG: "false"
  
  # Metrics
  ENABLE_METRICS: "true"
  METRICS_PORT: "9090"
  METRICS_PATH: "/metrics"
  
  # Health Checks
  HEALTH_CHECK_ENABLED: "true"
  HEALTH_CHECK_PATH: "/health"
  READINESS_CHECK_PATH: "/ready"
  
  # =============================================================================
  # EXTERNAL SERVICES CONFIGURATION
  # =============================================================================
  
  # Redis Configuration (non-sensitive)
  REDIS_HOST: "redis-svc"
  REDIS_PORT: "6379"
  REDIS_DB: "0"
  CACHE_TTL: "3600"
  CACHE_ENABLED: "true"
  
  # Email Configuration (non-sensitive)
  SMTP_HOST: "smtp.example.com"
  SMTP_PORT: "587"
  SMTP_SECURE: "false"
  EMAIL_FROM: "Hotel Check-in <noreply@example.com>"
  
  # External API URLs
  EXTERNAL_API_URL: "https://api.external.com"
  WEBHOOK_URL: "https://webhook.example.com"
  
  # =============================================================================
  # APPLICATION SETTINGS
  # =============================================================================
  
  # Timezone
  TZ: "UTC"
  
  # Locale
  DEFAULT_LOCALE: "en-US"
  
  # Pagination
  DEFAULT_PAGE_SIZE: "20"
  MAX_PAGE_SIZE: "100"
  
  # Session Configuration
  SESSION_TIMEOUT: "3600"
  SESSION_COOKIE_SECURE: "true"
  SESSION_COOKIE_HTTP_ONLY: "true"
  
  # =============================================================================
  # PRISMA CONFIGURATION
  # =============================================================================
  
  # Prisma Settings
  PRISMA_LOG_LEVEL: "info"
  PRISMA_ERROR_FORMAT: "pretty"
  
  # =============================================================================
  # DEPLOYMENT CONFIGURATION
  # =============================================================================
  
  # Graceful Shutdown
  SHUTDOWN_TIMEOUT: "30000"
  
  # Worker Configuration
  WORKER_THREADS: "4"
  
  # Request Timeout
  REQUEST_TIMEOUT: "30000"
  
  # =============================================================================
  # CONFIGURATION FILES
  # =============================================================================
  
  # Application Configuration File
  app.conf: |
    [server]
    host = 0.0.0.0
    port = 3000
    workers = 4
    
    [logging]
    level = info
    format = json
    requests = true
    
    [security]
    cors_enabled = true
    rate_limit = 100/15min
    helmet_enabled = true
    
    [database]
    pool_min = 2
    pool_max = 10
    connection_timeout = 30000
    
    [cache]
    enabled = true
    ttl = 3600
    
    [features]
    room_management = true
    online_checkin = true
    mobile_key = false
    payment_processing = true
  
  # Nginx Configuration (if using sidecar)
  nginx.conf: |
    server {
      listen 8080;
      server_name _;
      
      location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        proxy_connect_timeout 30s;
        proxy_send_timeout 30s;
        proxy_read_timeout 30s;
      }
      
      location /health {
        proxy_pass http://localhost:3000/health;
        access_log off;
      }
      
      location /metrics {
        proxy_pass http://localhost:9090/metrics;
        access_log off;
      }
    }
  
  # Logging Configuration
  logging.json: |
    {
      "level": "info",
      "format": "json",
      "timestamp": true,
      "colorize": false,
      "transports": [
        {
          "type": "console",
          "level": "info"
        },
        {
          "type": "file",
          "filename": "/var/log/app/application.log",
          "level": "info",
          "maxsize": 10485760,
          "maxFiles": 5
        },
        {
          "type": "file",
          "filename": "/var/log/app/error.log",
          "level": "error",
          "maxsize": 10485760,
          "maxFiles": 5
        }
      ]
    }